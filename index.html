<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delayed Auditory Feedback (DAF) Online Tool for Speech Fluency</title>
    <meta name="description"
        content="Free online Delayed Auditory Feedback (DAF) tool to improve speech fluency and reduce stuttering. Works instantly in your browser with no downloads required.">
    <meta name="keywords" content="DAF, Delayed Auditory Feedback, DAF Online, Speech Therapy, Speech Fluency, Stuttering Treatment, Stuttering App, Speech Delay, Speech Feedback, Free DAF">
    <meta name="author" content="DAF Online Tool">
    <meta name="robots" content="index, follow">
    <meta name="google-site-verification" content="WLiidijVk_rmBq5yNUVSfdG_TMNw0TkXGntIW_JF630" />
    
    <!-- Mobile specific meta tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="DAF Online">
    <meta name="apple-mobile-web-app-title" content="DAF Online">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0056b3">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://korayulusan.github.io/delayed-auditory-feedback-online/">
    <meta property="og:title" content="Delayed Auditory Feedback (DAF) Online Tool for Speech Fluency">
    <meta property="og:description" content="Free online Delayed Auditory Feedback (DAF) tool to improve speech fluency and reduce stuttering. Works instantly in your browser with no downloads required.">
    <meta property="og:image" content="https://korayulusan.github.io/delayed-auditory-feedback-online/images/daf-social-preview.png">
    <meta property="og:site_name" content="DAF Online Tool">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://korayulusan.github.io/delayed-auditory-feedback-online/">
    <meta name="twitter:title" content="Delayed Auditory Feedback (DAF) Online Tool for Speech Fluency">
    <meta name="twitter:description" content="Free online Delayed Auditory Feedback (DAF) tool to improve speech fluency and reduce stuttering. Works instantly in your browser with no downloads required.">
    <meta name="twitter:image" content="https://korayulusan.github.io/delayed-auditory-feedback-online/images/daf-social-preview.png">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://korayulusan.github.io/delayed-auditory-feedback-online/">
    
    <link rel="stylesheet" href="styles.css">
    <!-- Favicon setup for better Google search results -->
    <link rel="icon" href="favicon/favicon-32x32.png" type="image/png">
    <link rel="shortcut icon" href="favicon/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="57x57" href="favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
    <link rel="manifest" href="favicon/manifest.json">
    <meta name="msapplication-TileImage" content="favicon/ms-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="theme-color" content="#ffffff">
    
    <!-- Structured data for better SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Delayed Auditory Feedback (DAF) Online Tool",
      "url": "https://korayulusan.github.io/delayed-auditory-feedback-online/",
      "description": "Free online Delayed Auditory Feedback (DAF) tool to improve speech fluency and reduce stuttering. Works instantly in your browser.",
      "applicationCategory": "HealthApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "author": {
        "@type": "Organization",
        "name": "DAF Online",
        "url": "https://korayulusan.github.io/delayed-auditory-feedback-online/"
      },
      "keywords": "DAF, delayed auditory feedback, stuttering, speech therapy, speech fluency",
      "browserRequirements": "Requires a modern browser with microphone access"
    }
    </script>
</head>

<body>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-J3ZKY02K30"></script>
    <script src="analytics.js"></script>
    
    <header>
        <h1>Delayed Auditory Feedback (DAF) Online</h1>
        <p>Tip: This tool works best with headphones.</p>
        <p><strong>Privacy Notice:</strong> All audio processing is performed locally in your browser. No audio data is sent to any server.</p>
    </header>
    
    <main>
        <section id="controls">
            <hr />
            <button id="dafButton" onclick="toggleDAF(this)" aria-pressed="false">Start DAF</button>
            <p id="statusMessage" class="status-default">Waiting to connect to microphone</p>
            <p id="dafTimer" class="timer-display">00:00</p>
            <div class="sliders">
                <label for="delaySlider">‚è±Ô∏è Delay Time: <span id="delayValue">20 ms</span></label>
                <input type="range" id="delaySlider" min="0" max="500" step="1" value="20" oninput="updateDelayTime(this.value)" aria-valuemin="0" aria-valuemax="1000" aria-valuenow="200"
                    aria-valuetext="200 milliseconds">
                <label for="pitchSlider">üéµ Pitch Change: (Coming Soon) <span id="pitchValue">0 semitones</span></label>
                <input type="range" id="pitchSlider" min="-5" max="5" step="1" value="0" oninput="updatePitchChange(this.value)" aria-valuemin="-5" aria-valuemax="5" aria-valuenow="0"
                    aria-valuetext="0 semitones">
                <label for="inputGainSlider">üé§ Microphone Boost: <span id="inputGainValue">10x</span></label>
                <input id="inputGainSlider" type="range" min="1" max="20" value="10" step="0.5" oninput="updateInputGain(this.value)" aria-valuemin="1" aria-valuemax="20"
                    aria-valuenow="10" aria-valuetext="10x">
                <label for="noiseReductionSlider">üîá Background Noise Reduction: <span id="noiseReductionValue">0%</span></label>
                <input type="range" id="noiseReductionSlider" min="0" max="100" step="1" value="0" oninput="updateNoiseReduction(this.value)" aria-valuemin="0" aria-valuemax="100"
                    aria-valuenow="0" aria-valuetext="0%">
            </div>
            <hr />
        </section>
        
        <section id="infoBox" aria-labelledby="about-heading">
            <h2 id="about-heading">About the DAF Online App</h2>
            <p>
                The Delayed Auditory Feedback (DAF) Online App is an easy-to-use, web-based tool designed to assist users in improving speech fluency and managing speech-related
                challenges.
                DAF technology works by playing back a user's speech with a slight delay, which has been shown to help individuals who stutter or experience other speech disruptions.
            </p>
            <p>
                This app allows users to customize the delay time to suit their needs, providing real-time feedback that can slow down speech patterns and promote clearer articulation.
                With no need for downloads or installations, users can access the DAF system directly from their browser on desktops, tablets, or smartphones.
            </p>
            
            <section id="benefits" aria-labelledby="benefits-heading">
                <h3 id="benefits-heading">Benefits of Using DAF</h3>
                <ul>
                    <li><strong>Improved Fluency</strong> - Helps reduce stuttering and speech blocks</li>
                    <li><strong>Customizable Experience</strong> - Adjust delay time to find what works best for you</li>
                    <li><strong>Accessibility</strong> - Works on any device with a browser and microphone</li>
                    <li><strong>Privacy-focused</strong> - All processing happens locally, no data transmitted</li>
                    <li><strong>Free to Use</strong> - No cost, subscriptions or hidden fees</li>
                </ul>
            </section>
        </section>
    </main>
    
    <footer>
        <div class="theme-switch-wrapper">
            <em>Toggle Dark Mode</em>
            <label class="theme-switch" for="checkbox">
                <input type="checkbox" id="checkbox" onchange="toggleTheme()">
                <div class="slider round"></div>
            </label>
        </div>
        <p>&copy; <span id="currentYear"></span> DAF Online Tool. All rights reserved.</p>
    </footer>

    <script src="daf-processor.js"></script>
    <script>
        // Register service worker for background processing
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => {
                        console.log('Service Worker registered with scope:', registration.scope);
                        
                        // Request notification permission (helps with keeping audio running)
                        Notification.requestPermission();
                        
                        // Register for periodic background sync if available
                        if ('periodicSync' in registration) {
                            const syncOptions = {
                                tag: 'daf-background-sync',
                                minInterval: 60000 // 1 minute minimum
                            };
                            
                            registration.periodicSync.register(syncOptions)
                                .catch(err => console.log('Periodic sync could not be registered:', err));
                        }
                    })
                    .catch(err => console.log('Service Worker registration failed:', err));
            });
            
            // Keep service worker active when DAF is running
            let keepAliveInterval;
            function startKeepAlive() {
                if (keepAliveInterval) return;
                
                // Send periodic messages to keep the service worker active
                keepAliveInterval = setInterval(() => {
                    if (navigator.serviceWorker.controller) {
                        navigator.serviceWorker.controller.postMessage({
                            type: 'KEEP_ALIVE'
                        });
                    }
                }, 15000); // Every 15 seconds
            }
            
            function stopKeepAlive() {
                if (keepAliveInterval) {
                    clearInterval(keepAliveInterval);
                    keepAliveInterval = null;
                }
            }
            
            // Add event listeners to the DAF button to manage keep-alive
            document.getElementById('dafButton').addEventListener('click', function(e) {
                const isStarting = this.textContent === 'Start DAF';
                if (isStarting) {
                    startKeepAlive();
                } else {
                    stopKeepAlive();
                }
            });
        }
        
        // Prevent screen lock on mobile devices using NoSleep.js technique
        const preventSleep = {
            noSleep: null,
            video: null,
            
            enable: function() {
                if (!this.video) {
                    this.video = document.createElement('video');
                    this.video.setAttribute('playsinline', '');
                    this.video.setAttribute('muted', '');
                    this.video.setAttribute('loop', '');
                    this.video.setAttribute('width', '1');
                    this.video.setAttribute('height', '1');
                    this.video.style.position = 'absolute';
                    this.video.style.left = '-1px';
                    this.video.style.top = '-1px';
                    document.body.appendChild(this.video);
                    
                    // Create empty video source
                    this.video.src = 'data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAAAAG1wNDJtcDQxaXNvbWF2YzEAAATKbW9vdgAAAGxtdmhkAAAAANLEP5XSxD+VAAB1MAAAdU4AAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAACFpb2RzAAAAABCAgIAQAE////9//w6AgIAEAAAAAQAABDV0cmFrAAAAXHRraGQAAAAH0sQ/ldLEP5UAAAABAAAAAAAAdU4AAAAAAAAAAAAAAAABAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAABnaWYzMgAAAAAAAQxCAAAF/////wEAAAKZBMIAAAH4BMIAAAAGQEIAAAAP+BLj4QAAA+gAECU2ZEFUAAAAIGZkdGQAAAAAbWRtZGkAAAAAAAAIaGRscgAAAAAAAAAAAABtaXIxAAAAEEhtaXJoZGx\
yRlJBTUVfUkFURQAQIGhtaXJoZGxyAAAAAQAAABBobWlyaGRsctBpdHNjAAAAAAIAAAABAAAAEAAAABBtaXJtZGlhc3BlY3QAAAAAAQAAABBtaXJjb2RlY3MAAAAAAAAAAQAAABBtaXJoZGxyAAAAAQAAABBtaXJ2aWRlQVVESU9fREFUQRAAAAAgbWlyZGF0YQAAAAMgRlJBTUVfUkFURRAQIG1pcmhkbHIAAAABAAAAEG1pcmNvZGVjcwAAAAAAAAABAAAAEG1pcnZpZGUAAAAAAQAAABBtaXJkYXRh';
                }
                
                if (this.video) {
                    try {
                        this.video.play();
                        console.log('NoSleep video enabled');
                    } catch (e) {
                        console.error('Error enabling NoSleep:', e);
                    }
                }
            },
            
            disable: function() {
                if (this.video) {
                    this.video.pause();
                    console.log('NoSleep disabled');
                }
            }
        };
        
        // Add event listeners to manage sleep prevention
        document.getElementById('dafButton').addEventListener('click', function(e) {
            const isStarting = this.textContent === 'Start DAF';
            if (isStarting) {
                preventSleep.enable();
            } else {
                preventSleep.disable();
            }
        });
        
        window.onload = function () {
            // Set current year in footer
            document.getElementById('currentYear').textContent = new Date().getFullYear();
            // Apply saved theme preference
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.getElementById('checkbox').checked = savedTheme === 'dark';
            // Update sliders
            updateDelayTime(document.getElementById('delaySlider').value);
            updatePitchChange(document.getElementById('pitchSlider').value);
            updateInputGain(document.getElementById('inputGainSlider').value); // Fixed element ID
            updateNoiseReduction(document.getElementById('noiseReductionSlider').value);
        };

        function toggleTheme() {
            const checkbox = document.getElementById('checkbox');
            const themeColorMeta = document.querySelector('meta[name="theme-color"]');
            const theme = checkbox.checked ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', theme);
            themeColorMeta.setAttribute('content', theme === 'dark' ? '#121212' : '#ffffff');
            localStorage.setItem('theme', theme); // Save theme preference
        }
    </script>
</body>

</html>